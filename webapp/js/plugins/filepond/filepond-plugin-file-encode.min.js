/*
 * FilePondPluginFileEncode 1.0.3
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.FilePondPluginFileEncode=t()}(this,function(){"use strict";var e=function(){self.onmessage=function(t){e(t.data.message,function(e){self.postMessage({id:t.data.id,message:e})})};var e=function(e,t){var n=e.file,i=new FileReader;i.onloadend=function(){t(i.result.replace("data:","").replace(/^.+,/,""))},i.readAsDataURL(n)}},t=function(t){var n=t.addFilter,i=t.utils,a=i.Type,o=i.createWorker,r=i.createRoute,d=i.applyFilterChain;return n("CREATE_VIEW",function(t){var n=t.is,i=t.view,a=t.query;if(n("file-wrapper")&&a("GET_ALLOW_FILE_ENCODE")){var c=function(t){var n=t.root,i=t.action,r=a("GET_ITEM",i.id),c=r.file;d("PREPARE_OUTPUT",c,{query:a,item:r}).then(function(t){var i=o(e);i.post({file:t},function(e){n.ref.data.value=JSON.stringify({id:r.id,name:t.name,type:t.type,size:t.size,metadata:r.getMetadata(),data:e})})})["catch"](function(e){console.error(e)})};i.registerWriter(r({DID_LOAD_ITEM:function(e){var t=e.root,n=e.action;a("IS_ASYNC")||t.dispatch("FILE_ENCODE_ITEM",n,!0)},FILE_ENCODE_ITEM:c}))}}),{options:{allowFileEncode:[!0,a.BOOLEAN]}}};return document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t});